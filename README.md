# SickoMode-Malware- still in the works as of 7/28/2024

# Malware Analysis Report of unknown.exe.malz (SickoMode)

 

Creating detailed reports is a crucial aspect of malware analysis, as it provides a comprehensive overview of the findings and helps inform decision-making at higher levels, such as the CISO. I want to be different and instead of just answering questions, I wanted to do more of an analysis report, this is something you will have to do and to me is the most important part. Yes

 

# Executive Summary

SHA-256 Hash: 3ACA2A08CF296F1845D6171958EF0FFD1C8BDFC3E48BDD34A605CB1F7468213E

MD5 Hash: B9497FFB7E9C6F49823B95851EC874E3

This malware primary purpose is data exfiltration and it deletes itself after task completion or if the callback domain is not reachable. It is a nim-compiled malware that functions on the x64 windows operating system. 


# High-Level Technical Summary

This malware is a 64 bit executable and not packed. This malware is developed in the NIM prgramming language. This malware has no persistent mechansims. When the malware is executed it makes a call to  hxxp://update.ec12-4-109-278-3-ubuntu20-04.local.com


 ![Alt Text](https://github.com/JamahdPerry99/SickoMode-Malware-report/blob/3f16e043dbddcf405ae0d70a590b77e9af12a79d/malware%20high%20level%20example.png)


# Static Analysis

I started off by using FLOSS here below are some important strings I have found that I think is important.

    @:houdini
    @http://cdn.altimiter.local/feed?post=
    @Desktop\cosmo.jpeg
    @SikoMode
    @C:\Users\Public\passwrd.txt
    
    genKeystream__OOZOOZOOZOOZOOZOnimbleZpkgsZ8267524548O49O48Z826752_2
    toRC4__OOZOOZOOZOOZOOZOnimbleZpkgsZ8267524548O49O48Z826752_51
    @m..@s..@s..@s..@s..@s.nimble@spkgs@sRC4-0.1.0@sRC4.nim.c
Here below is what we get when we search the hash on virus total.

 ![Alt Text](https://github.com/JamahdPerry99/SickoMode-Malware-report/blob/152e6427b39f47a66d1a97d14803761a686af76e/malware%20analysis.jpg)

 With PE- Studio we see the following:

 ![Alt Text](https://github.com/JamahdPerry99/SickoMode-Malware-report/blob/dcf0006ded261fa876afad1e05e80c1d030f9d49/PE%20Studio%20static%20analysis.png)


# Basic Dynamic Analysis

On initional detonation, with no network simulation the malware deletes itself soon after execution.

On the second detonation, now with network simulation and the presence of wireshark we can see the 1st callback domain. the binary delets itself again. the binary is reaching out to "hxxp://update.ec12-4-109-278-3-ubuntu20-04[.]local"

![Alt Text](https://github.com/JamahdPerry99/SickoMode-Malware-report/blob/35ce379b066b1aadd4b5f5cb00b422809e3e9aef/2nd%20Detonation.png)


On the third detonation with Wireshark still running we a continuous stream of GET request with a changing value being posted. Once I stop inetsim(which is what I an using for network simulation), the binary then deletes itself from the host machine.


![Alt Text](https://github.com/JamahdPerry99/SickoMode-Malware-report/blob/35ce379b066b1aadd4b5f5cb00b422809e3e9aef/3rd%20Detonation.png)


Here we see the exfiltration domain which is constantly sending GET requests to the following domain hxxp://cdn.altimiter[.]local/feed?post= followed by a changing value, which we can infer is the data being sent.


The final last piece of dynamic analysis is that there are no mechanisms of persistence found but there is a key which is written to disk. 

We found this with using Procmon, a process monitoring tool which allows you to filter processes as they occur.



![Alt Text](https://github.com/JamahdPerry99/SickoMode-Malware-report/blob/c8b0e4e6578026b7da4e2c1a3356d967d81957a1/Procmon.png)


The password.txt contained the following key: 'SickoMode'. This is the file that was created by the malware.


![Alt Text](https://github.com/JamahdPerry99/SickoMode-Malware-report/blob/c8b0e4e6578026b7da4e2c1a3356d967d81957a1/Creation%20of%20password%20text%20file.png)


# Advaced Static Analysis

Next we enter the binary into cutter which is a disassembler, which will allow me to see the the breakdown/roots of the program. This also shows how the binary run step by step through the assembly.

![Alt Text](https://github.com/JamahdPerry99/SickoMode-Malware-report/blob/056fcf34f554051a28b1454d2029d528fd03174a/Overview.png)



We find the main program below:

![Alt Text](https://github.com/JamahdPerry99/SickoMode-Malware-report/blob/b77e558bf23f172a38bae733c5b6e6bf1c76c8c4/mainprogram.png)


looking into the assembly, we see the NimMainModule which is where the data exfiltration and deletion of the malware from the host occurs.

![Alt Text](https://github.com/JamahdPerry99/SickoMode-Malware-report/blob/a9198a16f00f3267d572a665597fc63fa5ab8464/NimMainModule%20explored%20more.png)


Next within the NimMainModule we find the following:

![Alt Text](https://github.com/JamahdPerry99/SickoMode-Malware-report/blob/3e793321f296dd3c51d0704f7cc53f11ee6bc172/Deeper%20into%20the%20NimMainModule.png)


After "checkKillSwitchURL__sickomode_25" is called the program goes to either "houdini__sickomode_51" or "setjmp". We also see "stealstuff__sickomode_130".

This portion of the NimMainModule appears to be where the encryption algorithm before data exfiltration and where the binary determines when to delete itself from the host system.

Within "stealstuff__sickomode_130", we see the encryption algorithm that this program uses:

![Alt Text](https://github.com/JamahdPerry99/SickoMode-Malware-report/blob/20f4f0a7848fc79c0f5d0108494b84741dfeb807/ENcryption%20being%20used.png)


After this portion, we see the NimMainModule use houdini to delete the binary and continue the program:

![Alt Text](https://github.com/JamahdPerry99/SickoMode-Malware-report/blob/bb5ef8f3b9b0d971d96d39be80ab69e15bcd3e59/binary%20deletes%20itself.png)


# Rules and Signatures

Yara Rules: This rule is created to search for the key strings I found during my analysis of this malware. The condition will return true if the detection finds a file that contains "nim", one of the callback domains and one of the functions found in the NimMainModule.

rule Yara_SickoMode {

    meta:
    last_updated = "8-11-2024"
    author = "Jamahd"
    description = "A yara rule for the sicko mode malware created by HuskyHacks"

    strings:
        //fill out identifying strings and other criteria
        $str1 = "nim"
        $str2 ="cdn.altimiter.local"
        $str3 = "houdini"
        $str4 = "toRC4"
        $str5 = "checkKillSwitchURL"
        $str6 = "stealstuff"
        $str7 = "update.ec12-4-109-278-3-ubuntu20-04.local"

    condition:
        //fill out the conditions that must be met to idenitfy the binary
        $str1 and ($str2 or $str7) and ($str3 or $str4 or $str5 or $str6)














